<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>招贤纳士-社会招聘</title>
<link href="style.css" rel="stylesheet" type="text/css" />
<script src="js/data.js"></script>
<script src="../$_1.0.js" type="text/javascript"></script>
</head>
<body>
  <div id="wrap">
  	<div class="left">
    	<h2>招贤纳士</h2>
      <ul>
      	<!-- <li class="focus"><a href="javascript:;">社会招聘</a></li>
      	<li><a href="javascript:;">校园招聘</a></li> -->
      </ul>
    </div>
  	<div class="right">
    	<div class="title">
      	<img src="img/shzp.gif" />
      </div>
      <div class="info">

      	<!-- <p class="zp">
        	<span><a href="">★ 职位需求：测试工程师【社会招聘】</a></span>
          <span>需求人数：2名</span>
         	<span class="date">2013年7月30日</span>
        </p>
      	<p class="yq">1.计算机或相关专业本科以上学历；2.从事软件测试工作3年及以上；3.具备良好的沟通能力和快速学习能力；4.精通测试策略和方法、测试用例设计；5.熟悉DB2、AIX等平台的基本操作；6.具备2年以上金...[<a href="">查看详情</a>]
        </p>

      	<p class="zp">
        	<span><a href="">★ 职位需求：测试工程师【社会招聘】</a></span>
          <span>需求人数：12名</span>
         	<span class="date">2013年7月30日</span>
        </p>
      	<p class="yq">1.计算机或相关专业本科以上学历；2.从事软件测试工作3年及以上；3.具备良好的沟通能力和快速学习能力；4.精通测试策略和方法、测试用例设计；5.熟悉DB2、AIX等平台的基本操作；6.具备2年以上金...[<a href="">查看详情</a>]
        </p>

      	<p class="zp">
        	<span><a href="">★ 职位需求：测试工程师【社会招聘】</a></span>
          <span>需求人数：21名</span>
         	<span class="date">2013年7月30日</span>
        </p>
      	<p class="yq">1.计算机或相关专业本科以上学历；2.从事软件测试工作3年及以上；3.具备良好的沟通能力和快速学习能力；4.精通测试策略和方法、测试用例设计；5.熟悉DB2、AIX等平台的基本操作；6.具备2年以上金...[<a href="">查看详情</a>]
        </p> -->

      </div>
      <div class="pages">
        <span class="prev">
          <a href="javascript:;">
            <img src="img/pre.gif">
          </a>
        </span>
        <span class="next">
          <a href="javascript:;">
            <img src="img/next.gif">
          </a>
        </span>
        <p>
         <!--  <span class="focus">
            <a href="javascript:;">1</a>
          </span>
          <span>
            <a href="javascript:;">2</a>
          </span>
          <span>
            <a href="javascript:;">3</a>
          </span> -->
        </p>
        
      </div>
      
    </div>
    <div class="clear"></div>
  </div>
<script type="text/javascript">
	var header = $('ul',$('left')[0])[0]; //ul
	var img = $('img',$('.title')[0])[0];//头部的图片
	var right = $('.right')[0];
	var inFo = $('.info',right)[0];//要插入内容的box
	var lis = header.children; //标题
	var arr = ['sh','xy']; //存放到底是走哪套数据的。
	var search = window.location.search.split('=')[1];
	var pages = $('p',$('.pages')[0])[0]; //添加页码的p
	var json = null;
	
	
	var html = '';
//	alert(search)
	
	//var sClass = '';
	
	//生成head中的内容
	var list = aData.list;
	for(var i=0;i<list.length;i++){
		//header.innerHTML += '<li class="'+(i?'':'focus')+'"><a href="">'+list[i].text+'</a></li>';
		header.innerHTML += '<li><a href="list4.html?s='+list[i].lx+'">'+list[i].text+'</a></li>';
	}
	
	//通过search值获取当前的数据。
	if(search){//如果有search就走对应的search值的数据(search：一种sh，另一个种xy)
		for(var i=0;i<list.length;i++){
			if(search == list[i].lx){ //循环list,通过判断找到当前页面中需要哪条数据
				json = aData[arr[i]];//aData['xy']||aData['sh'];
				lis[i].className = 'focus';
			}
		}
	}else{
		//一上来默认给它sh的数据;
		lis[0].className = 'focus';
		json = aData[arr[0]];
	}
	
	//设置每种数据对应的图片;
	img.src = json.img;
	
	//正式渲染数据
	//html
	
	/*
		  1  0-1   起始位置0   结束位置2
		  2  2-3   起始位置2   结束位置4
		  3  4-5   起始位置4   结束位置6
		  
		  num*2    num*2+2
		  
		  
		  0*2 0    0*2+2 = 2
		  
		  1*2 2    1*2+2 = 4
		  
		  2*2 4    2*2+2 = 6
		  
	*/
	
	
	function createElement(num){
			html = '';
			console.log(json)
			for(var i=num*2;i<num*2+2;i++){
				if(json.text[i]){ //如果有数据才渲染，不加会报错，因为第4页只有一条数据,每一次循环都是循环2次。
					html += '<p class="zp">'+
					'<span><a href="">★ 职位需求：'+json.text[i].zw+'</a></span>'+
	          	'<span>需求人数：'+json.text[i].rs+'名</span>'+
	         	'<span class="date">'+json.text[i].sj[0]+'年'+json.text[i].sj[1]+'月'+json.text[i].sj[2]+'日</span>'+
	        '</p>'+
	      	'<p class="yq">'+json.text[i].info[0].l.join('').substring(0,98)+'...[<a href="content2.html?s='+json.name+'#page='+i+'">查看详情</a>]'+
	        '</p>';
				}
	      //console.log(json.text[i].info[0].l.join('').substring(0,98));
		}
		inFo.innerHTML = html;
	}
	
	
	//生成页码
	
	var pageLength = Math.ceil(json.text.length/2);
	for(var i=0;i<pageLength;i++){
			pages.innerHTML += '<span><a href="javascript:;">'+(i+1)+'</a></span>';
	}
	var pageSpan = pages.children; 
	pageSpan[0].className = 'focus';
	//console.log(pageLength)
	
	
	//当页面加载的时候，就获取hash值，为了通过hash值来渲染数据
	var hash = window.location.hash;
	//看看hash值有没有？有找到hash并且将有用的信息获取到：没有就默认设置1
	if(hash){
			hash = hash.split('=')[1];
	}else{
			hash = 1;
	}
	createElement(hash-1);
	for(var i=0;i<pageSpan.length;i++){
		pageSpan[i].className = '';
	}
	if(pageSpan[hash-1]){
		pageSpan[hash-1].className = 'focus';
	}else{
			window.location.hash = 'p='+1;
	}
	
	//alert(hash)
	
	
	//点击页码，为了设置新的hash值
	for(var i=0;i<pageSpan.length;i++){
		pageSpan[i].index = i;
		pageSpan[i].onclick = function(){
			//alert(1)
			window.location.hash = 'p='+(this.index+1);
			//createElement(this.index);
		}
	}
	//当hash值改变的时候，获取hash并且重新渲染数据，将页面的样式更改
	window.onhashchange = function(){
			hash = window.location.hash.split('=')[1];
			createElement(hash-1);
			for(var i=0;i<pageSpan.length;i++){
				pageSpan[i].className = '';
			}
			if(pageSpan[hash-1]){
					pageSpan[hash-1].className = 'focus';
			}else{
					window.location.hash = 'p='+1;
			}
		
			//alert(hash)
	}
	
	//获取上一个，下一个
	
	var prev = $('.prev', $('.pages')[0])[0];
	var next = $('.next', $('.pages')[0])[0];
	var numPage = parseInt(hash); //hash获取出来的是字符串，转成数字类型
	next.onclick = function(){
			numPage++;
			if(numPage > pageLength){
					numPage = pageLength;
			}
			window.location.hash = 'p='+numPage;
			createElement(numPage-1);
	}
	
	prev.onclick = function(){
			numPage--;
			if(numPage <= 1){
					numPage = 1;
			}
			window.location.hash = 'p='+numPage;
			createElement(numPage-1);
	}
	
	
	
	
	
	
	
	
	//console.log(json);
	
	
	//console.log(inFo)
	
</script>
</body>
</html>
